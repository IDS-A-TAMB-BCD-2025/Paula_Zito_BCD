USE BD_SUPERMECADO_FUNCIONARIO_PRODUTO_CONSUMIDOR;

INSERT INTO SUPERMECADO (SUP_CNPJ, SUP_RAZAO_SOCIAL,SUP_TELEFONE,SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("123456780001", "Supermecado Grick","199999999","gricktambau@email.com","Grick Street","10000","TambaCity","SP");

INSERT INTO SUPERMECADO (SUP_CNPJ, SUP_RAZAO_SOCIAL,SUP_TELEFONE,SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("27.654.321/0001", "Orion Sistemas de Automação LTDA","(11) 95847-2231","contato@orionautomacao.com.br","
Rua das Palmeiras","427","Rocinha","MG");

INSERT INTO SUPERMECADO (SUP_CNPJ, SUP_RAZAO_SOCIAL,SUP_TELEFONE,SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("34.890.765/0001", "Solaris Equipamentos Industriais S/A","(31) 99451-3320","comercial@solaris.ind.br","Avenida Dom Pedro II","345","Limeira","SJ");

INSERT INTO SUPERMECADO (SUP_CNPJ, SUP_RAZAO_SOCIAL,SUP_TELEFONE,SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("56.123.987/0001", "Boreal Alimentos Naturais LTDA","(41) 99122-8745","vendas@borealalimentos.com","Rua das Araucárias","987","catacoco","BH");

INSERT INTO SUPERMECADO (SUP_CNPJ, SUP_RAZAO_SOCIAL,SUP_TELEFONE,SUP_EMAIL, SUP_ENDERECO_LOGRADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES ("78.432.110/0001", "Atlântica Consultoria e Serviços LTDA","(21) 97788-6655","suporte@atlanticaconsultoria.com","Avenida das Américas","789","pindamonhangaba","AM");



INSERT INTO PRODUTO ( PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("8956723534", "Arroz 5kg", "5.0","500","26.90","2025-12-25" );

INSERT INTO PRODUTO ( PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("7891234567", "Leite Integral Bom Sabor 1L", "1.0","24","4.90","2026-03-15" );

INSERT INTO PRODUTO ( PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("6576535456", "Cafe 2kg", "2.0","433","30.50","2025-09-11" );

INSERT INTO PRODUTO ( PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("123434244", "Sabonete Hidratante Flor de Algodão
Peso: 90 g", "90","50","3.50","2027-01-01" );

INSERT INTO PRODUTO ( PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES ("6467678679", "Refrigerante Citrus 2L", "2.0","30","7.90","2028-05-05" );



INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME,CON_TELEFONE, CON_EMAIL)
VALUES ("123445","Paula zito", "19 0987665","paulazito@hotmail.com");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME,CON_TELEFONE, CON_EMAIL)
VALUES ("345676","Isabela campo", "19 07656745","isacampo@hotmail.com");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME,CON_TELEFONE, CON_EMAIL)
VALUES ("234457","Jose ramon", "19 3434566","joseramon@hotmail.com");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME,CON_TELEFONE, CON_EMAIL)
VALUES ("9775656","Lia carina", "19 22233456","liacat@hotmail.com");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME,CON_TELEFONE, CON_EMAIL)
VALUES ("4544222","Ana laura", "19 23436578","analaura@hotmail.com");



INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES("7453635", "Jose Joao","1999-03-23", "19 8897076", "josejoao@gmail.com","carteirajose.pdf", "1234", "56789", "2020-04-09", "44 horas","123456780001");

INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES("4534346", "Maria betina","1877-06-29", "19 45434545", "mariabe@gmail.com","carteiramaria.pdf", "3456", "12345", "2021-04-30", "44 horas","27.654.321/0001");

INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES("233211", "gabriel","1989-02-25", "19 5678599", "gabriel@gmail.com","carteiragab.pdf", "5678", "2342", "2025-04-22", "44 horas","34.890.765/0001");

INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES("098889", "catarina","1955-05-11", "19 3423523", "cat@gmail.com","carteiracat.pdf", "5678", "1234", "2019-04-01", "44 horas","56.123.987/0001");

INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES("536634", " Joao","1959-03-03", "19 56456", "joao@gmail.com","carteirajoao.pdf", "5555", "23131", "2020-09-09", "44 horas","78.432.110/0001");


INSERT INTO SUPERMECADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES
("123456780001", 1),  -- Supermercado Grick -> Arroz 5kg
("27.654.321/0001", 2),  -- BomPreço -> Feijão Carioca
("34.890.765/0001", 3),  -- PagueMenos -> Açúcar Refinado
("56.123.987/0001", 4),  -- Central -> Óleo de Soja
("78.432.110/0001", 5);  -- Econômico -> Café Torrado e Moído

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES
("1234455", 1),  -- Gabriel Evaristo comprou Arroz
("3456786", 2),  -- Mariana Oliveira comprou Feijão
("234457", 3),  -- Lucas Andrade comprou Açúcar
("9775656", 4),  -- Fernanda Lima comprou Óleo de Soja
("4544222", 5);  -- João Pedro Ramos comprou Café



SELECT * FROM SUPERMECADO;
SELECT * FROM PRODUTO;
/*CONSULTAR O AUMENTO DE R$ 2,00 NO PREÇO DOS PRODUTOS COM PREÇO ATUAL >= R$5,00*/

SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_PRECO AS "PREÇO ATUAL", TRUNCATE((PRO_PRECO+2),2) AS "PREÇO COM AJUSTE DE R$ 2,00"
FROM PRODUTO
WHERE PRO_PRECO >=5;


/*CONSULTAR A REDUÇAO DE R$1,00 NO PREÇO DOS PRODUTOS COM O PREÇO ATUAL DE R$5,00*/

SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS", PRO_PRECO AS "PRECO ATUAL", 
TRUNCATE((PRO_PRECO - 1),2) AS "PREÇO COM REDUÇÃO DE R$ 1,00"

FROM PRODUTO
WHERE PRO_PRECO <=10;

/*CONSULTAR COMO SERIA APLICAR UM DESCONTO DE 10% EM TODOS OS PRODUTOS */

SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CODIGO DE BARRAS", PRO_PRECO AS "PREÇO ATUAL",
(PRO_PRECO - (PRO_PRECO * 0.1)) AS "PRECO COM DESCONTO DE 10%"
FROM PRODUTO;


/*AJUSTAR O ESTOQUE DO PRIMEIRO PRODUTO, DIVIDINDO PELA METADE*/

SELECT PRO_ID, PRO_NOME, PRO_CODIGO_BARRAS, PRO_QUANTIDADE
FROM PRODUTO;

UPDATE PRODUTO
SET PRO_QUANTIDADE = PRO_QUANTIDADE/2
WHERE PRO_ID = 1;


/*CONSULTAR TODOS OS PRODUTOS QUE TENHAM DATA DE VALIDADE ENTRE SETEMBRO DE 2025 E DEZEMBRO DE 2025*/
SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CODIGO DE BARRAS", PRO_DATA_VALIDADE AS "DATA DE VALIDADE"
FROM PRODUTO
WHERE PRO_DATA_VALIDADE BETWEEN '2025-09-01' AND '2025-12-31';


/*CONSULTAR TODOS OS PRODUTOS QUE TENHAM PREÇO MAIOR QUE R$10 OU MENOR QUE R$4*/
SELECT PRO_NOME AS "NOME", PRO_CODIGO_BARRAS AS "CODIGO DE BARRAS", PRO_PRECO AS "PRECO"
FROM PRODUTO
WHERE PRO_PRECO >= 10 OR PRO_PRECO <= 4;


/*CONSULTAR OS DDS E TELEFONE DOS CONSUMIDORES SEPARADAMENTE*/
SELECT CON_NOME AS "NOME DO CONSUMIDOR", CON_CPF AS "CPF DO CONSUMIDOR", SUBSTRING(CON_TELEFONE,1,2) AS "DDD DO TELEFONE",SUBSTRING(CON_TELEFONE,3,9) AS "NUMERO DO TELEFONE"
FROM CONSUMIDOR;


/*GERAR UMA FRASE CONCATENANDO: RAZÃO SOCIAL, CNPJ, TELEFONE E EMAIL*/
SELECT	CONCAT("Razao Social:", SUP_RAZAO_SOCIAL, 
		CONCAT ("| CNPJ:", SUP_CNPJ),
        CONCAT("| Telefone:",SUP_TELEFONE), 
        CONCAT("| Email:", SUP_EMAIL)) AS FRASE
FROM SUPERMECADO;


/*GERAR UMA CONSULTA QUE VERIFICA O STATUS DO ESTOQUE DOS PRODUTOS, REGRAS: 
1) QUANTIDADE <= 25: ESTOQUE BAIXO
2)QUANTIDADE >= 25 E QUANTIDADE <=100: ESTOQUE MÉDIO
3)QUANTIDADE > 100: ESTOQUE ALTO*/
SELECT 	PRO_NOME 			AS "NOME DO PRODUTO", 
		PRO_CODIGO_BARRAS 	AS "CÓDIGO DE BARRAS", 
        PRO_QUANTIDADE		AS "QUANTIDADE",
        CASE
			WHEN PRO_QUANTIDADE <= 25 THEN "ESTOQUE BAIXO"
			WHEN PRO_QUANTIDADE > 25 AND PRO_QUANTIDADE < 100 THEN "ESTOQUE MÉDIO"
            WHEN PRO_QUANTIDADE >= 100 THEN "ESTOQUE ALTO"
		END AS "NÍVEL DE ESTOQUE"
FROM PRODUTO;


/*GERAR UMA CONSULTA QUE VERIFICA O PESO DOS PRODUTOS.RETORNAR : NOME, CODIGO DE BARRAS, QUANTIDADE, PESO E DATA DE VALIDADE REGRAS:
1) PESO <= 5:PESO BAIXO
2) PESO > 5 E PESO <= 50: PESO MÉDIO
3) PESO >= 50: PESO ALTO*/
SELECT 	PRO_NOME 			AS "NOME DO PRODUTO", 
		PRO_CODIGO_BARRAS 	AS "CÓDIGO DE BARRAS", 
        PRO_QUANTIDADE		AS "QUANTIDADE",
        PRO_PESO            AS "PESO",
        PRO_DATA_VALIDADE   AS "VALIDADE",
        CASE
			WHEN PRO_PESO <= 5 THEN "PESO BAIXO"
			WHEN PRO_PESO > 5 AND PRO_PESO <= 50 THEN "PESO MÉDIO"
            WHEN PRO_PESO >= 50 THEN "PESO ALTO"
		END AS "CLASSIFICAÇÃO DO PESO"
FROM PRODUTO;


/*CONTAR QUANTOS CONSUMIDORES TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM CONSUMIDOR;

SELECT COUNT(*)
FROM SUPERMECADO;

SELECT COUNT(*)
FROM FUNCIONARIO;

SELECT COUNT(*)
FROM PRODUTO;


/*SOMAR O PREÇO TOTAL DE TODOS OS PRODUTOS CADASTRADOS*/
SELECT SUM(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$", TRUNCATE(SUM(PRO_PRECO),2)) AS "SOMA TOTAL"
FROM PRODUTO;


/*CALCULAR A MÉDIA DE PREÇO DOS PRODUTOS*/
SELECT AVG(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$", TRUNCATE(AVG(PRO_PRECO),2)) AS "MÉDIA DE PREÇO"
FROM PRODUTO;

/*SELECIONAR O PRODUTO MAIS CARO*/
SELECT MAX(PRO_PRECO)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MAIOR QUANTIDADE*/
SELECT MAX(PRO_QUANTIDADE)
FROM PRODUTO;

/*SELECIONAR O PRODUTO MAIS BARATO*/
SELECT MIN(PRO_PRECO)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MENOR QUANTIDADE*/
SELECT MIN(PRO_QUANTIDADE)
FROM PRODUTO;

/*SELECIONAR A DAQTA E HORA ATUAL*/
SELECT NOW() FROM DUAL;


SELECT 	FUN_NOME AS "NOME DO FUNCIONARIO",
		DATE_FORMAT(FUN_DATA_NASCIMENTO, "%d/%m/%Y") AS "DATA DE NASCIMENTO", 
        TIMESTAMPDIFF(YEAR, FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM FUNCIONARIO;


/*FUNÇÕES MATEMÁTICAS:
ABS- VALOR ABSOLUTO DE UM NÚMERO
ROUND- ARREDONDAR
POWER- POTENCIA*/
SELECT ABS(-10),
	ROUND(PRO_PRECO) AS "PREÇO ARREDONDADO",
	POWER(PRO_PRECO,2) AS "PREÇO ELEVADOS AO QUADRADO"
FROM PRODUTO;


/*UPPER, LOWER, TRIM*/
SELECT 	UPPER(FUN_NOME) AS "MAIÚSCULAS",
		LOWER(FUN_NOME) AS "MINÚSCULAS",
        TRIM("        Paula") AS "TIRANDO ESPEÇOS"
FROM FUNCIONARIO;


SELECT PRO_QUANTIDADE,
		COUNT(*) AS "REPETIÇÕES"
FROM PRODUTO
GROUP BY PRO_QUANTIDADE;


/*UNION*/
SELECT	FUN_NOME,
		FUN_CPF
FROM FUNCIONARIO
UNION
SELECT 	FUN_NOME,
		FUN_CPF
FROM FUNCIONARIO;

SELECT * FROM PRODUTO;

/*UNION*/
SELECT PRO_NOME
FROM PRODUTO
UNION
SELECT "Arroz 5kg"
FROM DUAL
UNION
SELECT "iogurt do Bob Esponja"
FROM DUAL;

/*UNION ALL*/
SELECT PRO_NOME
FROM PRODUTO
UNION ALL
SELECT "Arroz 5kg"
FROM DUAL
UNION ALL
SELECT "iogurt do Bob Esponja"
FROM DUAL;

/*SELECT COM WHERE*/
SELECT FUN_NOME 	AS "NOME DO FUNCIONÁRIO",
FUN_CPF 			AS "CPF DO FUNCIONÁRIO",
FUN_DATA_NASCIMENTO AS "DATA DE NASCIMENTO",
TIMESTAMPDIFF (YEAR, FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM FUNCIONARIO
WHERE TIMESTAMPDIFF (YEAR, FUN_DATA_NASCIMENTO,NOW()) >= 25
AND TIMESTAMPDIFF (YEAR, FUN_DATA_NASCIMENTO,NOW()) <=35;


/*RETORNAR OS FUNCIONARIOS CONSUMIDORES E SUPERMECADOS COM EMAIL IGUAL A GMAIL OU OUTLOOK*/
SELECT 	CON_NOME 		AS "NOME",
		CON_CPF 		AS "CPF/CNPJ",
		CON_TELEFONE 	AS "TELEFONE",
		CON_EMAIL 		AS "EMAIL",
        "CONSUMIDOR"	AS "TIPO"
FROM 	CONSUMIDOR
WHERE 	UPPER (CON_EMAIL) LIKE "%GMAIL%"
OR 		UPPER (CON_EMAIL) LIKE "%OUTLOOK%"
UNION
SELECT 	FUN_NOME 		AS"NOME",
		FUN_CPF 		AS "CPF/CNPJ",
		FUN_TELEFONE 	AS "TELEFONE",
		FUN_EMAIL 		AS "EMAIL",
		"FUNCIONARIO" 	AS "TIPO"
FROM FUNCIONARIO
WHERE UPPER(FUN_EMAIL) 	LIKE "%GMAIL%"
OR UPPER(FUN_EMAIL) 	LIKE "%OUTLOOK%"
UNION
SELECT	SUP_RAZAO_SOCIAL 	AS "NOME",
		SUP_CNPJ 			AS "CPF/CNPJ",
		SUP_TELEFONE 		AS "TELEFONE",
        SUP_EMAIL   		AS "EMAIL",
        "SUPERMECADO"   	AS "TIPO"
FROM SUPERMECADO
WHERE UPPER(SUP_EMAIL) 	LIKE "%GMAIL%"
OR UPPER(SUP_EMAIL) 	LIKE "%OUTLOOK%";


/*CROSS JOIN: RETORNAR TODOS OS PRODUTOS E OS SUPERMECADOS QUE SÃO VENDIDOS*/
SELECT 		PRODUTO.PRO_NOME 				AS "NOME",
			PRODUTO.PRO_CODIGO_BARRAS 		AS "CÓDIGO DE BARRAS",
            SUPERMECADO.SUP_RAZAO_SOCIAL 	AS "RAZÃO SOCIAL"
FROM 		SUPERMECADO_PRODUTO
CROSS JOIN 	SUPERMECADO
CROSS JOIN 	PRODUTO
WHERE		PRODUTO.PRO_ID = SUPERMECADO_PRODUTO.FK_PRO_ID
AND 		SUPERMECADO.SUP_CNPJ = SUPERMECADO_PRODUTO.FK_SUP_CNPJ;


/*INNER JOIN:RETORNAR APENAS OS PRODUTOS QUE FORAM COMPRADOS POR ALGUM CONSUMIDOR*/
SELECT 		PRODUTO_CONSUMIDOR.PCO_ID 	AS "ID DA CONTA",
			PRODUTO.PRO_NOME 			AS "NOME DO PRODUTO",
            PRODUTO.PRO_CODIGO_BARRAS 	AS "CODIGO DE BARRAS",
            CONSUMIDOR.CON_NOME 		AS "NOME DO CONSUMIDOR",
            CONSUMIDOR.CON_CPF 			AS "CPF DO CONSUMIDOR"
FROM 		PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*EXERCÍCIO COM INNER JOIN: RETORNAR APENAS OS FUNCIONÁRIOS QUE TRABALHAM  EM UM SUPERMECADO, RETORNAR O NOME DO FUNCIONÁRIO E O NOME DO SUPERMECADO QUE ELE TRABALHA */
SELECT 		SUPERMECADO.SUP_RAZAO_SOCIAL	AS "RAZÃO SOCIAL",
            FUNCIONARIO.FUN_NOME 			AS "NOME DO FUNCIONÁRIO"
FROM 		SUPERMECADO
INNER JOIN FUNCIONARIO ON (SUPERMECADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);


/*EXERCÍCIO COM INNER JOIN: RETORNAR APENAS OS PRODUTOS QUE EXISTAM EM UM SUPERMECADO, RETORNAR O NOME DO PRODUTO E O NOME DO SUPERMECADO QUE ELE ESTA DISPONÍVEL*/
SELECT 		PRODUTO.PRO_NOME 				AS "NOME",
            SUPERMECADO.SUP_RAZAO_SOCIAL 	AS "RAZÃO SOCIAL"
FROM 		SUPERMECADO_PRODUTO
INNER JOIN 	SUPERMECADO ON (SUPERMECADO_PRODUTO.FK_SUP_CNPJ = SUPERMECADO.SUP_CNPJ)
INNER JOIN 	PRODUTO ON (SUPERMECADO_PRODUTO.FK_PRO_ID = PRODUTO.PRO_ID);


/*LEFT JOIN*/
INSERT INTO PRODUTO(PRO_CODIGO_BARRAS,PRO_NOME,PRO_PESO,PRO_QUANTIDADE,PRO_PRECO,PRO_DATA_VALIDADE)
VALUES				("3333333", "Kit Kat", "30", "1500", 4.50, "2026-01-01");

SELECT PRODUTO.PRO_NOME, SUPERMECADO.SUP_RAZAO_SOCIAL
FROM PRODUTO
LEFT JOIN SUPERMECADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMECADO_PRODUTO.FK_PRO_ID)
LEFT JOIN SUPERMECADO ON (SUPERMECADO.SUP_CNPJ = SUPERMECADO_PRODUTO.FK_SUP_CNPJ);


SELECT * FROM SUPERMECADO;

SELECT PRODUTO.PRO_NOME, SUPERMECADO.SUP_RAZAO_SOCIAL
FROM PRODUTO
RIGHT JOIN SUPERMECADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMECADO_PRODUTO.FK_PRO_ID)
RIGHT JOIN SUPERMECADO ON (SUPERMECADO.SUP_CNPJ = SUPERMECADO_PRODUTO.FK_SUP_CNPJ);


/*SELECT COM LEFT  E RIGHT JOIN*/
SELECT*
FROM (
		SELECT S.SUP_RAZAO_SOCIAL AS RAZAO_SOCIAL,
				F.FUN_NOME AS NOME_FUNCIONARIO,
				P.PRO_NOME AS NOME_PRODUTO,
				C.CON_NOME AS NOME_CONSUMIDOR
		FROM SUPERMECADO S 
        LEFT JOIN FUNCIONARIO F 			ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
        LEFT JOIN SUPERMECADO_PRODUTO SP 	ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
        LEFT JOIN PRODUTO P 				ON (SP.FK_PRO_ID = P.PRO_ID)
        LEFT JOIN PRODUTO_CONSUMIDOR PC 	ON (P.PRO_ID = PC.FK_PRO_ID)
        LEFT JOIN CONSUMIDOR C 				ON (PC.FK_CON_CPF = C.CON_CPF)
        
        UNION
        
        SELECT S.SUP_RAZAO_SOCIAL AS RAZAO_SOCIAL,
				F.FUN_NOME AS NOME_FUNCIONARIO,
				P.PRO_NOME AS NOME_PRODUTO,
				C.CON_NOME AS NOME_CONSUMIDOR
		FROM SUPERMECADO S 
        RIGHT JOIN FUNCIONARIO F 			ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
        RIGHT JOIN SUPERMECADO_PRODUTO SP 	ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
        RIGHT JOIN PRODUTO P 				ON (SP.FK_PRO_ID = P.PRO_ID)
        RIGHT JOIN PRODUTO_CONSUMIDOR PC 	ON (P.PRO_ID = PC.FK_PRO_ID)
        RIGHT JOIN CONSUMIDOR C 			ON (PC.FK_CON_CPF = C.CON_CPF)
) SELECT_EXTERNO
ORDER BY 	SELECT_EXTERNO.RAZAO_SOCIAL 	ASC,
			SELECT_EXTERNO.NOME_FUNCIONARIO DESC,
            SELECT_EXTERNO.NOME_PRODUTO 	ASC,
            SELECT_EXTERNO.NOME_CONSUMIDOR 	DESC;

/*EXERCICIO 1- INNER JOIN */

SELECT 		PRODUTO.PRO_NOME 				AS "NOME",
            SUPERMECADO.SUP_RAZAO_SOCIAL 	AS "RAZÃO SOCIAL"
FROM 		SUPERMECADO_PRODUTO
INNER JOIN 	SUPERMECADO ON (SUPERMECADO_PRODUTO.FK_SUP_CNPJ = SUPERMECADO.SUP_CNPJ)
INNER JOIN 	PRODUTO ON (SUPERMECADO_PRODUTO.FK_PRO_ID = PRODUTO.PRO_ID);

/*EXERCICIO 2- INNER JOIN*/

SELECT 		SUPERMECADO.SUP_RAZAO_SOCIAL	AS "RAZÃO SOCIAL",
            FUNCIONARIO.FUN_NOME 			AS "NOME DO FUNCIONÁRIO"
FROM 		SUPERMECADO
INNER JOIN FUNCIONARIO ON (SUPERMECADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

/*EXERCICIO 3- INNER JOIN*/

SELECT 		CONSUMIDOR.CON_NOME 			AS "CONSUMIDOR",	
			PRODUTO.PRO_NOME 				AS "NOME"
FROM 		PRODUTO_CONSUMIDOR
INNER JOIN 	CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF)
INNER JOIN 	PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID);

/*EXERCICIO 4- INNER JOIN*/

SELECT 		PRODUTO.PRO_NOME 				AS "NOME",
			CONSUMIDOR.CON_NOME 			AS "CONSUMIDOR"
FROM 		PRODUTO_CONSUMIDOR
INNER JOIN 	PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN 	CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*EXERCICIO 5- INNER JOIN*/

SELECT 		COUNT(PRODUTO.PRO_QUANTIDADE),
            SUPERMECADO.SUP_RAZAO_SOCIAL AS "RAZAO SOCIAL"
FROM 		SUPERMECADO_PRODUTO
INNER JOIN 	SUPERMECADO ON (SUPERMECADO_PRODUTO.FK_SUP_CNPJ = SUPERMECADO.SUP_CNPJ)
INNER JOIN 	PRODUTO ON (SUPERMECADO_PRODUTO.FK_PRO_ID = PRODUTO.PRO_ID)
GROUP BY SUPERMECADO.SUP_RAZAO_SOCIAL;

/*EXERCICIO 1 - LEFT JOIN*/

SELECT 	SUPERMECADO.SUP_RAZAO_SOCIAL,
		PRODUTO.PRO_NOME
FROM SUPERMECADO
LEFT JOIN SUPERMECADO_PRODUTO ON (SUPERMECADO.SUP_CNPJ = SUPERMECADO_PRODUTO.FK_SUP_CNPJ)
LEFT JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMECADO_PRODUTO.FK_PRO_ID);



/*EXERCICIO 2 - LEFT JOIN*/

SELECT 		FUNCIONARIO.FUN_NOME 			AS "NOME DO FUNCIONÁRIO",
			SUPERMECADO.SUP_RAZAO_SOCIAL	AS "RAZÃO SOCIAL"
FROM 		FUNCIONARIO
LEFT JOIN SUPERMECADO ON (SUPERMECADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);


/*EXERCICIO 3 - LEFT JOIN*/

SELECT 	CONSUMIDOR.CON_NOME,
		PRODUTO.PRO_NOME
FROM CONSUMIDOR
LEFT JOIN PRODUTO_CONSUMIDOR ON(CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF)
LEFT JOIN PRODUTO ON(PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID);


/*EXERCICIO 4 - LEFT JOIN*/

SELECT	PRODUTO.PRO_NOME,
		CONSUMIDOR.CON_NOME
FROM PRODUTO
LEFT JOIN PRODUTO_CONSUMIDOR ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID)
LEFT JOIN CONSUMIDOR  ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF);
	
    
/*EXERCICIO 5 - LEFT JOIN*/

SELECT S.SUP_RAZAO_SOCIAL,
F.FUN_NOME
FROM SUPERMECADO S 
LEFT JOIN FUNCIONARIO F ON (S.SUP_CNPJ = F.FK_SUP_CNPJ);



/*EXERCICIO 1 - RIGHT JOIN*/

SELECT SUPERMECADO.SUP_RAZAO_SOCIAL,
PRODUTO.PRO_NOME
FROM SUPERMECADO
RIGHT JOIN SUPERMECADO_PRODUTO ON (SUPERMECADO.SUP_CNPJ = SUPERMECADO_PRODUTO.FK_SUP_CNPJ)
RIGHT JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMECADO_PRODUTO.FK_PRO_ID);


/*EXERCICIO 2 - RIGHT JOIN */

SELECT CONSUMIDOR.CON_NOME,
PRODUTO.PRO_NOME
FROM CONSUMIDOR
RIGHT JOIN PRODUTO_CONSUMIDOR ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF)
RIGHT JOIN PRODUTO ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID); 


/*EXERCICIO 3 - RIGHT JOIN*/

SELECT FUNCIONARIO.FUN_NOME,
SUPERMECADO.SUP_RAZAO_SOCIAL
FROM FUNCIONARIO
RIGHT JOIN SUPERMECADO ON (SUPERMECADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ); 


/*EXERCICIO 4 - RIGHT JOIN*/

SELECT PRODUTO.PRO_NOME AS "NOME DO PRODUTO",
	   SUPERMECADO.SUP_RAZAO_SOCIAL AS "NOME DO MERCADO"
FROM PRODUTO
RIGHT JOIN SUPERMECADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMECADO_PRODUTO.FK_PRO_ID)
RIGHT JOIN SUPERMECADO ON (SUPERMECADO.SUP_CNPJ = SUPERMECADO_PRODUTO.FK_SUP_CNPJ);


/*EXERCICIO 5 - RIGHT JOIN*/
SELECT PRODUTO.PRO_NOME AS "NOME DO PRODUTO",
       CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR"
FROM   PRODUTO_CONSUMIDOR
RIGHT JOIN PRODUTO ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID)
RIGHT JOIN CONSUMIDOR ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF);


